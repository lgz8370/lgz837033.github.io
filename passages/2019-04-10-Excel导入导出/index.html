<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Excel导入导出 | LGZ</title>
    <meta name="description" content="落魄后端,在线炒粉">
    
    
    <link rel="preload" href="/assets/css/0.styles.d30c544a.css" as="style"><link rel="preload" href="/assets/js/app.b207c50f.js" as="script"><link rel="preload" href="/assets/js/3.0772832a.js" as="script"><link rel="preload" href="/assets/js/20.6a00bc44.js" as="script"><link rel="prefetch" href="/assets/js/1.82ff88c9.js"><link rel="prefetch" href="/assets/js/10.b68dbdee.js"><link rel="prefetch" href="/assets/js/11.71deef42.js"><link rel="prefetch" href="/assets/js/12.bdea2b77.js"><link rel="prefetch" href="/assets/js/13.6e22270c.js"><link rel="prefetch" href="/assets/js/14.e6b10163.js"><link rel="prefetch" href="/assets/js/15.65bb6088.js"><link rel="prefetch" href="/assets/js/16.8aa9c66d.js"><link rel="prefetch" href="/assets/js/17.74e1cf4b.js"><link rel="prefetch" href="/assets/js/18.409fab5b.js"><link rel="prefetch" href="/assets/js/19.a12869f5.js"><link rel="prefetch" href="/assets/js/21.d624464c.js"><link rel="prefetch" href="/assets/js/22.42f25c0b.js"><link rel="prefetch" href="/assets/js/23.714a054c.js"><link rel="prefetch" href="/assets/js/24.1ae687a7.js"><link rel="prefetch" href="/assets/js/25.5aedf653.js"><link rel="prefetch" href="/assets/js/26.8a0740a6.js"><link rel="prefetch" href="/assets/js/27.00f434df.js"><link rel="prefetch" href="/assets/js/28.12b76410.js"><link rel="prefetch" href="/assets/js/29.9d3b4ca3.js"><link rel="prefetch" href="/assets/js/30.1820424d.js"><link rel="prefetch" href="/assets/js/31.54a6bffd.js"><link rel="prefetch" href="/assets/js/32.31c8efc4.js"><link rel="prefetch" href="/assets/js/33.10385ef8.js"><link rel="prefetch" href="/assets/js/34.f27dee2e.js"><link rel="prefetch" href="/assets/js/35.a9cb67af.js"><link rel="prefetch" href="/assets/js/36.9f752de5.js"><link rel="prefetch" href="/assets/js/37.8308ed01.js"><link rel="prefetch" href="/assets/js/38.40a5eab3.js"><link rel="prefetch" href="/assets/js/39.3ec6c34e.js"><link rel="prefetch" href="/assets/js/4.5509e90c.js"><link rel="prefetch" href="/assets/js/40.43ea9f93.js"><link rel="prefetch" href="/assets/js/41.53add7c5.js"><link rel="prefetch" href="/assets/js/42.d780592a.js"><link rel="prefetch" href="/assets/js/43.95931812.js"><link rel="prefetch" href="/assets/js/44.25eae553.js"><link rel="prefetch" href="/assets/js/45.58267eb5.js"><link rel="prefetch" href="/assets/js/46.f601e62e.js"><link rel="prefetch" href="/assets/js/47.bcc5b42d.js"><link rel="prefetch" href="/assets/js/48.edd522c3.js"><link rel="prefetch" href="/assets/js/49.2ab49069.js"><link rel="prefetch" href="/assets/js/5.13703bcb.js"><link rel="prefetch" href="/assets/js/50.f70840f2.js"><link rel="prefetch" href="/assets/js/51.2ac3e203.js"><link rel="prefetch" href="/assets/js/52.4af3ff81.js"><link rel="prefetch" href="/assets/js/53.d9940b59.js"><link rel="prefetch" href="/assets/js/54.0e816113.js"><link rel="prefetch" href="/assets/js/55.f2b6bb88.js"><link rel="prefetch" href="/assets/js/56.e848599b.js"><link rel="prefetch" href="/assets/js/57.5f83aa72.js"><link rel="prefetch" href="/assets/js/58.f06f7f87.js"><link rel="prefetch" href="/assets/js/59.647ca050.js"><link rel="prefetch" href="/assets/js/6.4eccc923.js"><link rel="prefetch" href="/assets/js/60.c0cdfc9f.js"><link rel="prefetch" href="/assets/js/61.9db474d6.js"><link rel="prefetch" href="/assets/js/7.abea6dde.js"><link rel="prefetch" href="/assets/js/8.e3fabf99.js"><link rel="prefetch" href="/assets/js/9.9d1d4300.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d30c544a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">LGZ</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/guide/" class="nav-link">归档</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/guide/" class="nav-link">归档</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><blockquote><p>记录一个<code>java</code>基于<code>jxl</code>实现的<code>Excel</code>导入导出功能
</p></blockquote> <h5 id="一-引入依赖"><a href="#一-引入依赖" class="header-anchor">#</a> 一. 引入依赖</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;dependency&gt;
	&lt;groupId&gt;net.sourceforge.jexcelapi&lt;/groupId&gt;
	&lt;artifactId&gt;jxl&lt;/artifactId&gt;
	&lt;version&gt;2.6.12&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="二-导出"><a href="#二-导出" class="header-anchor">#</a> 二. 导出</h5> <h6 id="_2-0-接口编写"><a href="#_2-0-接口编写" class="header-anchor">#</a> 2.0 接口编写</h6> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/export&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
	<span class="token class-name">WritableWorkbook</span> workbook <span class="token operator">=</span> <span class="token class-name">Workbook</span><span class="token punctuation">.</span><span class="token function">createWorkbook</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 响应格式</span>
	response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;application/vnd.ms-excel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Disposition&quot;</span><span class="token punctuation">,</span> &quot;attachment<span class="token punctuation">;</span>
    					filename<span class="token operator">=</span><span class="token string">&quot; + URLEncoder.encode(&quot;</span>文件名称<span class="token punctuation">.</span>xls<span class="token string">&quot;, &quot;</span>UTF<span class="token operator">-</span><span class="token number">8</span>&quot;<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 创建一个工作簿:</span>
	<span class="token class-name">WritableSheet</span> sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">createSheet</span><span class="token punctuation">(</span><span class="token string">&quot;工作簿名称&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">Label</span> label1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Label</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;商品id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	sheet1<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span>label1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">Label</span> label2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Label</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;公司编号&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	sheet1<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span>label2<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//查询数据写到workbook中</span>
	workbook<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;查询数据写到workbook中&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//关闭资源</span>
	workbook<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h6 id="_2-1-导出效果如下"><a href="#_2-1-导出效果如下" class="header-anchor">#</a> 2.1 导出效果如下</h6> <p><img src="data:image/png;base64,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" alt="filename already exists, renamed"></p> <h5 id="三-导入"><a href="#三-导入" class="header-anchor">#</a> 三. 导入</h5> <h6 id="_3-0-读取excel接口"><a href="#_3-0-读取excel接口" class="header-anchor">#</a> 3.0 读取<code>Excel</code>接口</h6> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/excel&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">importExcel</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ItemDto</span><span class="token punctuation">&gt;</span></span> items <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">ItemDto</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">try</span> <span class="token punctuation">{</span>
		<span class="token comment">//获取xls文件Excel</span>
		workbook <span class="token operator">=</span> <span class="token class-name">Workbook</span><span class="token punctuation">.</span><span class="token function">getWorkbook</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//获取商品工作簿:可通过索引获取不同工作簿</span>
		<span class="token class-name">Sheet</span> itemSheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">getSheet</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//获取总行数</span>
		<span class="token keyword">int</span> rows <span class="token operator">=</span> itemSheet<span class="token punctuation">.</span><span class="token function">getRows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//格式化导入的日期格式</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">Cell</span><span class="token punctuation">[</span><span class="token punctuation">]</span> row <span class="token operator">=</span> itemSheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>row<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token class-name">String</span> itemId <span class="token operator">=</span> itemSheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>itemId<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token class-name">String</span> scompCode <span class="token operator">=</span> itemSheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>scompCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
		<span class="token comment">//关闭资源</span>
		workbook<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><div class="my-loader center" style="display:none;" data-v-16b71b14><div class="my-loader-circle" data-v-16b71b14></div></div></div></div>
    <script src="/assets/js/app.b207c50f.js" defer></script><script src="/assets/js/3.0772832a.js" defer></script><script src="/assets/js/20.6a00bc44.js" defer></script>
  </body>
</html>
